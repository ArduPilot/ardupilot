this is NOT generic driver from ST, but fixed two bugs