# hw definition file for processing by chibios_hwdef.py for H757
# CubeNode pin descriptions can be found at https://docs.cubepilot.org/user-guides/cubenode/pin-descriptions

include ../CubeNode/hwdef.inc

# CAN2
PB5 CAN2_RX CAN2
PB6 CAN2_TX CAN2

# SERIAL

# UART 1
PE1 UART8_TX UART8
PE0 UART8_RX UART8

# UART 2
PC6 USART6_TX USART6
PC7 USART6_RX USART6

# UART 3
undef PE7
undef PE8
PE7 UART7_RX UART7
PE8 UART7_TX UART7
PE10 UART7_CTS UART7
PE9 UART7_RTS UART7

# UART 4
PB9 UART4_TX UART4
PB8 UART4_RX UART4
PB0 UART4_CTS UART4
PA15 UART4_RTS UART4

undef SERIAL_ORDER
SERIAL_ORDER OTG1 UART8 USART6 UART7 UART4 OTG2

# I2C

# I2C 1
PA8 I2C3_SCL I2C3
PC9 I2C3_SDA I2C3

# I2C 2
PD12 I2C4_SCL I2C4
PD13 I2C4_SDA I2C4

I2C_ORDER I2C3 I2C4

# No Baro on the board, allow boot without
define HAL_BARO_ALLOW_INIT_NO_BARO

# LEDs
PB1 LED_BLUE OUTPUT LOW GPIO(0)
PA4 LED_GREEN OUTPUT LOW GPIO(1)
PE6 LED_RED OUTPUT LOW GPIO(2)

define AP_NOTIFY_GPIO_LED_3_ENABLED 1
define HAL_GPIO_A_LED_PIN 0
define HAL_GPIO_B_LED_PIN 1
define HAL_GPIO_C_LED_PIN 2

# PWM output for buzzer
PE5 TIM15_CH1 TIM15 GPIO(77) ALARM

# pins for SD card:
PB14 SDMMC2_D0 SDMMC2
PB15 SDMMC2_D1 SDMMC2
PB3 SDMMC2_D2 SDMMC2
PB4 SDMMC2_D3 SDMMC2
PD6 SDMMC2_CK SDMMC2
PD7 SDMMC2_CMD SDMMC2

# Enable FAT filesystem support (needs a microSD defined via SDMMC).
define HAL_OS_FATFS_IO 1
define FATFS_HAL_DEVICE SDCD2

# Define some PWM pins. We also map these pins to GPIO
PE11 TIM1_CH2 TIM1 PWM(1) GPIO(50) BIDIR
PE13 TIM1_CH3 TIM1 PWM(2) GPIO(51) BIDIR
PE14 TIM1_CH4 TIM1 PWM(3) GPIO(52)
PA5  TIM2_CH1 TIM2 PWM(4) GPIO(53) BIDIR
PB10 TIM2_CH3 TIM2 PWM(5) GPIO(54) BIDIR
PB7  TIM4_CH2 TIM4 PWM(6) GPIO(55) BIDIR
PD14 TIM4_CH3 TIM4 PWM(7) GPIO(56) BIDIR
PD15 TIM4_CH4 TIM4 PWM(8) GPIO(57)

# RC input
PC8 TIM3_CH3 TIM3 RCININT PULLDOWN

# Analog inputs
PA0 BATT_VOLTAGE_SENS ADC1 SCALE(1)
PF11 BATT_CURRENT_SENS ADC1 SCALE(1)
PF12 BATT2_VOLTAGE_SENS ADC1 SCALE(1)
PC0 BATT2_CURRENT_SENS ADC1 SCALE(1)

# 5v and servo rail analog inputs
PF5 VDD_5V_SENS ADC3 SCALE(2)
PF3 FMU_SERVORAIL_VCC_SENS ADC3 SCALE(3)

# This is the pin that senses USB being connected.
PA9 VBUS INPUT OPENDRAIN

# Power flag pins
PA6 VDD_BRICK_VALID INPUT PULLUP
PF4 VDD_BRICK2_VALID INPUT PULLUP

# external CS pins for SPI
PF14 EXT_CS CS
PF13 EXT_CS1 CS
