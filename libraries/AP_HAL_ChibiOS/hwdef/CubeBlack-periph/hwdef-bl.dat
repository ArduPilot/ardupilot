# hw definition file for processing by chibios_hwdef.py
# for F4 bootloader

# MCU class and specific type
MCU STM32F4xx STM32F427xx

# crystal frequency
OSCILLATOR_HZ 24000000

# board ID for firmware load
APJ_BOARD_ID 1401

FLASH_SIZE_KB 2048

# setup build for a peripheral firmware
env AP_PERIPH 1

# bootloader is installed at zero offset
FLASH_RESERVE_START_KB 0

# the location where the bootloader will put the firmware
# we use first 32k
FLASH_BOOTLOADER_LOAD_KB 32

define HAL_LED_ON 0

# order of UARTs (and USB)
SERIAL_ORDER OTG1 UART7

# UART7 maps to uartF in the HAL (serial5 in SERIALn_ parameters).
PE7 UART7_RX UART7
PE8 UART7_TX UART7

# Pin for PWM Voltage Selection
PB4 PWM_VOLT_SEL OUTPUT HIGH

PA11 OTG_FS_DM OTG1
PA12 OTG_FS_DP OTG1

PA13 JTMS-SWDIO SWD
PA14 JTCK-SWCLK SWD

define HAL_USE_EMPTY_STORAGE 1
define HAL_STORAGE_SIZE 16384

# Add CS pins to ensure they are high in bootloader
PC1 MAG_CS CS
PC2 MPU_CS CS
PC13 GYRO_EXT_CS CS
PC14 BARO_EXT_CS CS
PC15 ACCEL_EXT_CS CS
PD7 BARO_CS CS
PE4 MPU_EXT_CS CS
PD10 FRAM_CS CS SPEED_VERYLOW

# the first CAN bus
PD0 CAN1_RX CAN1
PD1 CAN1_TX CAN1

# This defines the pins for the 2nd CAN interface, if available.
PB6 CAN2_TX CAN2
PB12 CAN2_RX CAN2

# reserve 256 bytes for comms between app and bootloader
RAM_RESERVE_START 256

# use DNA
define HAL_CAN_DEFAULT_NODE_ID 0

define CAN_APP_NODE_NAME "org.ardupilot.CubeBlack-periph"
